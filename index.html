<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Royal Keno KZ</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700;900&family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{--gold:#D4AF37;--gold2:#F5D060;--gold3:#8B6914;--em:#00C878;--em2:#00FF9A;--ruby:#E63950;--obs:#050508;--d1:#0C0C12;--d2:#121218;--d3:#1A1A24;--bdr:rgba(212,175,55,0.15);--bdr2:rgba(212,175,55,0.35);--txt:#EEE8D5;--mut:#5A5470;}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;user-select:none;}
html,body{height:100%;overflow:hidden;background:var(--obs);}
body{color:var(--txt);font-family:'Montserrat',sans-serif;font-size:14px;}
#bg-canvas{position:fixed;inset:0;z-index:0;pointer-events:none;}
.app{position:relative;z-index:1;display:flex;flex-direction:column;height:100vh;height:100dvh;overflow:hidden;}
.hdr{flex-shrink:0;background:linear-gradient(180deg,rgba(12,12,18,.98),rgba(12,12,18,.92));border-bottom:1px solid var(--bdr2);padding:10px 14px;display:flex;align-items:center;justify-content:space-between;backdrop-filter:blur(20px);position:relative;}
.hdr::after{content:'';position:absolute;bottom:-1px;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent);}
.logo{font-family:'Cinzel',serif;font-size:14px;font-weight:900;letter-spacing:3px;background:linear-gradient(135deg,var(--gold3),var(--gold2),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent;filter:drop-shadow(0 0 8px rgba(212,175,55,.4));}
.bal-pill{display:flex;align-items:center;gap:5px;background:rgba(212,175,55,.06);border:1px solid var(--bdr2);padding:5px 12px;border-radius:24px;cursor:pointer;}
.bal-pill .amt{font-family:'Cinzel',serif;font-size:13px;font-weight:700;color:var(--gold2);letter-spacing:1px;}
.nav{flex-shrink:0;display:flex;background:var(--d1);border-bottom:1px solid var(--bdr);overflow-x:auto;scrollbar-width:none;}
.nav::-webkit-scrollbar{display:none;}
.nv{flex:0 0 auto;padding:9px 12px;background:none;border:none;color:var(--mut);font-family:'Montserrat',sans-serif;font-size:10px;font-weight:700;cursor:pointer;transition:all .25s;white-space:nowrap;letter-spacing:1.5px;text-transform:uppercase;position:relative;}
.nv::after{content:'';position:absolute;bottom:0;left:50%;right:50%;height:2px;background:linear-gradient(90deg,var(--gold3),var(--gold2));transition:all .3s cubic-bezier(.34,1.56,.64,1);border-radius:2px 2px 0 0;}
.nv.on{color:var(--gold2);}.nv.on::after{left:6px;right:6px;}
.scr{flex:1;overflow-y:auto;overflow-x:hidden;padding:14px 13px 16px;scrollbar-width:thin;scrollbar-color:var(--gold3) transparent;}
.scr::-webkit-scrollbar{width:3px;}.scr::-webkit-scrollbar-thumb{background:var(--gold3);border-radius:2px;}
.card{background:linear-gradient(135deg,rgba(26,26,36,.95),rgba(18,18,24,.95));border:1px solid var(--bdr);border-radius:14px;padding:15px;margin-bottom:11px;position:relative;overflow:hidden;}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(212,175,55,.4),transparent);}
.ctit{font-family:'Cinzel',serif;font-size:10px;font-weight:700;color:var(--gold);letter-spacing:3px;text-transform:uppercase;margin-bottom:13px;}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;width:100%;padding:12px 18px;border:none;border-radius:10px;font-family:'Montserrat',sans-serif;font-size:13px;font-weight:700;cursor:pointer;letter-spacing:1.5px;text-transform:uppercase;transition:all .15s;}
.btn:active{transform:scale(.97);}.btn:disabled{opacity:.35;cursor:not-allowed;transform:none;}
.btn-gold{background:linear-gradient(135deg,#8B6914,#D4AF37,#F5D060,#D4AF37);background-size:200%;color:#1a1200;box-shadow:0 4px 20px rgba(212,175,55,.3);}
.btn-em{background:linear-gradient(135deg,#006640,#00C878);color:#001a0d;}
.btn-ghost{background:transparent;border:1px solid var(--bdr2);color:var(--gold);}
.btn-ruby{background:linear-gradient(135deg,#7a1020,#E63950);color:#fff;}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:8px;}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;}
.fld{margin-bottom:11px;}
.flbl{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--mut);margin-bottom:5px;font-weight:700;}
.inp{width:100%;background:rgba(5,5,8,.8);border:1px solid var(--bdr);border-radius:8px;padding:10px 13px;color:var(--txt);font-family:'Montserrat',sans-serif;font-size:15px;font-weight:600;outline:none;transition:border-color .2s;-webkit-appearance:none;}
.inp:focus{border-color:var(--gold);}.inp::placeholder{color:var(--mut);}
.pres{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:11px;}
.pre{padding:5px 9px;background:rgba(212,175,55,.05);border:1px solid var(--bdr);border-radius:6px;color:var(--mut);font-family:'Montserrat',sans-serif;font-size:11px;font-weight:700;cursor:pointer;transition:all .15s;}
.pre.on,.pre:active{border-color:var(--gold);color:var(--gold);background:rgba(212,175,55,.1);}
.res{border-radius:12px;padding:16px;text-align:center;margin-top:13px;animation:rPop .4s cubic-bezier(.34,1.56,.64,1);}
.rw{background:rgba(0,200,120,.08);border:1px solid rgba(0,200,120,.25);}
.rl{background:rgba(230,57,80,.08);border:1px solid rgba(230,57,80,.2);}
.rt{background:rgba(212,175,55,.08);border:1px solid rgba(212,175,55,.2);}
.rbig{font-family:'Cinzel',serif;font-size:24px;font-weight:900;}
.rw .rbig{color:var(--em2);}.rl .rbig{color:var(--ruby);}.rt .rbig{color:var(--gold2);}
.rsub{font-size:10px;color:var(--mut);margin-top:4px;letter-spacing:2px;text-transform:uppercase;}
.sl{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--bdr);}
.sl:last-child{border:none;}.sk{color:var(--mut);font-size:12px;}.sv{font-weight:700;font-size:13px;font-family:'Cinzel',serif;}
.spinner{width:18px;height:18px;border:2px solid var(--bdr);border-top-color:var(--gold);border-radius:50%;animation:spin .6s linear infinite;display:inline-block;}
.loading{display:flex;align-items:center;justify-content:center;gap:8px;padding:30px;color:var(--mut);}
.toast{position:fixed;bottom:74px;left:50%;transform:translateX(-50%);background:rgba(18,18,24,.97);border:1px solid var(--bdr2);border-radius:10px;padding:9px 18px;font-size:13px;font-weight:600;color:var(--txt);z-index:9999;white-space:nowrap;backdrop-filter:blur(10px);animation:slideUp .3s ease;}
.particle{position:fixed;pointer-events:none;z-index:9998;font-size:20px;animation:pFly 1.2s ease forwards;}
.welcome{display:flex;flex-direction:column;align-items:center;padding:16px 4px;}
.wlogo{font-family:'Cinzel',serif;font-size:26px;font-weight:900;background:linear-gradient(135deg,var(--gold3),var(--gold2),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:6px;animation:float 3s ease infinite;}
.perk{display:flex;align-items:center;gap:10px;padding:9px 13px;background:rgba(212,175,55,.04);border:1px solid var(--bdr);border-radius:10px;margin-bottom:7px;}
.avatar{width:68px;height:68px;border-radius:50%;background:linear-gradient(135deg,var(--gold3),var(--gold2));display:flex;align-items:center;justify-content:center;margin:0 auto 10px;box-shadow:0 0 30px rgba(212,175,55,.3);animation:glow 2s ease infinite;font-size:30px;}
.vip-b{display:inline-flex;align-items:center;gap:5px;background:linear-gradient(135deg,var(--gold3),var(--gold));color:#1a1000;padding:3px 11px;border-radius:20px;font-family:'Cinzel',serif;font-size:11px;font-weight:700;letter-spacing:2px;}
.hrow{display:flex;align-items:center;gap:8px;padding:9px 0;border-bottom:1px solid var(--bdr);}
.hrow:last-child{border:none;}.hico{width:32px;height:32px;border-radius:8px;background:var(--d3);display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;}
.hinfo{flex:1;}.hgame{font-size:12px;font-weight:700;}.hdate{font-size:10px;color:var(--mut);margin-top:2px;}
.hamt{font-family:'Cinzel',serif;font-size:13px;font-weight:700;}.hamt.w{color:var(--em2);}.hamt.l{color:var(--ruby);}
.trow{display:flex;align-items:center;gap:10px;padding:9px 0;border-bottom:1px solid var(--bdr);}
.trow:last-child{border:none;}.trank{font-family:'Cinzel',serif;font-size:16px;font-weight:900;width:28px;color:var(--mut);}
.trank.g{color:#FFD700;}.trank.s{color:#C0C0C0;}.trank.b{color:#CD7F32;}
.tname{flex:1;font-weight:700;font-size:14px;}.tbal{color:var(--gold);font-weight:700;font-size:13px;font-family:'Cinzel',serif;}
.pay-opt{display:flex;align-items:center;gap:12px;padding:12px;background:rgba(212,175,55,.04);border:1px solid var(--bdr);border-radius:10px;margin-bottom:8px;}
.pay-opt.on{border-color:var(--gold);background:rgba(212,175,55,.1);}
.ref-link{background:var(--obs);border:1px solid var(--bdr2);border-radius:8px;padding:10px 13px;font-size:11px;color:var(--gold2);word-break:break-all;margin-bottom:10px;cursor:pointer;}
.rss{flex:1;text-align:center;padding:12px;background:rgba(212,175,55,.04);border:1px solid var(--bdr);border-radius:10px;}
.rssv{font-family:'Cinzel',serif;font-size:22px;font-weight:700;color:var(--gold2);}
.rssl{font-size:10px;color:var(--mut);text-transform:uppercase;letter-spacing:1px;margin-top:3px;}
.arena{background:radial-gradient(ellipse at 50% 100%,rgba(0,200,120,.06),transparent 70%),linear-gradient(180deg,var(--d1),var(--obs));border:1px solid var(--bdr);border-radius:14px;height:185px;display:flex;flex-direction:column;align-items:center;justify-content:center;margin-bottom:13px;position:relative;overflow:hidden;}
.arena canvas{position:absolute;inset:0;width:100%;height:100%;}
.cmult{font-family:'Cinzel',serif;font-size:50px;font-weight:900;position:relative;z-index:2;line-height:1;transition:color .3s;}
.cmult.idle{color:var(--gold2);}.cmult.fly{color:var(--em2);animation:rkP .4s ease infinite;}.cmult.boom{color:var(--ruby);animation:shake .4s ease;}
.cst{font-size:10px;letter-spacing:3px;text-transform:uppercase;margin-top:5px;position:relative;z-index:2;}
.cst.idle{color:var(--mut);}.cst.fly{color:var(--em);}.cst.boom{color:var(--ruby);}
.smach{background:linear-gradient(180deg,var(--obs),var(--d1));border:2px solid var(--bdr2);border-radius:16px;padding:14px 10px;margin-bottom:13px;position:relative;}
.smach::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--gold),transparent);border-radius:16px 16px 0 0;}
.reels{display:flex;gap:7px;}.reel{flex:1;height:88px;background:var(--obs);border:1px solid var(--bdr);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:40px;transition:all .15s;}
.reel.win{border-color:var(--gold);box-shadow:0 0 20px rgba(212,175,55,.4);animation:glow 1s ease infinite;}
.sline{position:absolute;top:50%;left:0;right:0;height:2px;transform:translateY(-50%);background:linear-gradient(90deg,transparent,rgba(212,175,55,.6),transparent);pointer-events:none;}
.felt{background:radial-gradient(ellipse at 50% 100%,#0d3320,#071a10);border:2px solid rgba(0,80,30,.6);border-radius:16px;padding:14px;margin-bottom:11px;min-height:195px;position:relative;}
.felt::before{content:'';position:absolute;inset:5px;border:1px solid rgba(0,100,40,.3);border-radius:10px;pointer-events:none;}
.hlbl{font-size:9px;letter-spacing:3px;color:rgba(255,255,255,.3);text-transform:uppercase;margin-bottom:5px;font-family:'Cinzel',serif;}
.hand{display:flex;flex-wrap:nowrap;margin-bottom:5px;min-height:62px;align-items:center;}
.pc{width:42px;height:60px;border-radius:6px;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;padding:3px 4px;font-size:12px;font-weight:900;border:1px solid rgba(0,0,0,.2);box-shadow:2px 3px 8px rgba(0,0,0,.5);flex-shrink:0;margin-right:-8px;animation:cD .25s cubic-bezier(.34,1.56,.64,1);font-family:'Cinzel',serif;position:relative;}
.pc.wh{background:linear-gradient(135deg,#fff,#f0f0f0);color:#111;}.pc.rd{background:linear-gradient(135deg,#fff,#f5e8e8);color:#c0392b;}
.pc.bk{background:linear-gradient(135deg,#1a3a8f,#0d1f5f);align-items:center;justify-content:center;font-size:22px;}
.pcs{font-size:10px;position:absolute;bottom:2px;right:3px;opacity:.7;}
.ws{display:flex;justify-content:center;margin-bottom:15px;}
.wo{width:150px;height:150px;border-radius:50%;background:conic-gradient(#c0392b 0 9.73deg,#111 9.73deg 19.46deg,#c0392b 19.46deg 29.19deg,#111 29.19deg 38.92deg,#c0392b 38.92deg 48.65deg,#111 48.65deg 58.38deg,#c0392b 58.38deg 68.11deg,#111 68.11deg 77.84deg,#c0392b 77.84deg 87.57deg,#2ecc71 87.57deg 97.3deg,#c0392b 97.3deg 107.03deg,#111 107.03deg 116.76deg,#c0392b 116.76deg 126.49deg,#111 126.49deg 136.22deg,#c0392b 136.22deg 145.95deg,#111 145.95deg 155.68deg,#c0392b 155.68deg 165.41deg,#111 165.41deg 175.14deg,#c0392b 175.14deg 184.87deg,#111 184.87deg 194.6deg,#c0392b 194.6deg 204.33deg,#111 204.33deg 214.06deg,#c0392b 214.06deg 223.79deg,#111 223.79deg 233.52deg,#c0392b 233.52deg 243.25deg,#111 243.25deg 252.98deg,#c0392b 252.98deg 262.71deg,#111 262.71deg 272.44deg,#c0392b 272.44deg 282.17deg,#111 282.17deg 291.9deg,#c0392b 291.9deg 301.63deg,#111 301.63deg 311.36deg,#c0392b 311.36deg 321.09deg,#111 321.09deg 330.82deg,#c0392b 330.82deg 340.55deg,#111 340.55deg 350.28deg,#c0392b 350.28deg 360deg);border:3px solid var(--gold);display:flex;align-items:center;justify-content:center;transition:transform 2.5s cubic-bezier(.17,.67,.08,1);}
.wi{width:40px;height:40px;border-radius:50%;background:radial-gradient(circle,var(--d2),var(--obs));border:2px solid var(--gold);display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:12px;font-weight:700;color:var(--gold2);}
.wp{position:absolute;top:-5px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:12px solid var(--gold);}
.bts{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:11px;}
.bt{padding:9px 7px;border-radius:8px;border:1px solid var(--bdr);background:rgba(5,5,8,.6);color:var(--mut);font-family:'Montserrat',sans-serif;font-size:12px;font-weight:700;cursor:pointer;text-align:center;transition:all .2s;}
.bt.on{border-color:var(--gold);background:rgba(212,175,55,.08);color:var(--gold2);}
.kg{display:grid;grid-template-columns:repeat(10,1fr);gap:3px;margin-bottom:11px;}
.kn{aspect-ratio:1;border-radius:5px;background:rgba(5,5,8,.8);border:1px solid rgba(212,175,55,.08);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;cursor:pointer;transition:all .12s;}
.kn:active{transform:scale(.85);}.kn.sel{background:rgba(212,175,55,.15);border-color:var(--gold);color:var(--gold2);}
.kn.drw{background:rgba(0,200,120,.1);border-color:rgba(0,200,120,.4);color:var(--em2);}
.kn.hit{background:rgba(212,175,55,.3);border-color:var(--gold);color:var(--gold2);animation:hitP .5s ease;}
.ksts{display:flex;justify-content:space-between;margin-bottom:9px;}
.ksv{font-family:'Cinzel',serif;font-size:17px;font-weight:700;color:var(--gold2);}
.ksl{font-size:9px;color:var(--mut);letter-spacing:2px;text-transform:uppercase;margin-top:2px;}
.bnav{flex:0 0 auto;display:flex;background:var(--d1);border-top:1px solid var(--bdr);padding:6px 2px;}
.bni{flex:1;background:none;border:none;padding:5px 2px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:2px;}
.bni span:first-child{font-size:17px;}
.bni .dot{width:4px;height:4px;border-radius:50%;transition:all .2s;}
@keyframes rPop{from{opacity:0;transform:scale(.85) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}
@keyframes glow{0%,100%{box-shadow:0 0 10px rgba(212,175,55,.3)}50%{box-shadow:0 0 30px rgba(212,175,55,.7)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-4px)}40%{transform:translateX(4px)}60%{transform:translateX(-3px)}80%{transform:translateX(3px)}}
@keyframes cD{from{opacity:0;transform:translateX(-20px) rotate(-5deg)}to{opacity:1;transform:translateX(0)}}
@keyframes rkP{0%,100%{transform:scale(1) translateY(0)}50%{transform:scale(1.08) translateY(-4px)}}
@keyframes hitP{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}
@keyframes slideUp{from{opacity:0;transform:translate(-50%,20px)}to{opacity:1;transform:translate(-50%,0)}}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
@keyframes pFly{0%{opacity:1;transform:translateY(0) scale(1)}100%{opacity:0;transform:translateY(-120px) scale(.3) rotate(360deg)}}
</style>
</head>
<body>
<canvas id="bg-canvas"></canvas>
<div id="root"></div>
<script type="text/babel">
const {useState,useEffect,useRef} = React;
const tg = window.Telegram?.WebApp;
const tgUser = tg?.initDataUnsafe?.user;
const API = "https://YOUR_SERVER/api";

async function api(m,b={},silent=false){
  try{
    const r=await fetch(`${API}/${m}`,{method:"POST",headers:{"Content-Type":"application/json","X-Init-Data":tg?.initData||""},body:JSON.stringify(b)});
    return await r.json();
  }catch(e){if(!silent)showToast("‚ö†Ô∏è –ù–µ—Ç —Å–≤—è–∑–∏");return{ok:false};}
}

class Snd{
  i(){if(!this.c)this.c=new(window.AudioContext||window.webkitAudioContext)();}
  b(f,d,t='sine',v=.12){if(!this.c)return;const o=this.c.createOscillator(),g=this.c.createGain();o.connect(g);g.connect(this.c.destination);o.type=t;o.frequency.value=f;g.gain.setValueAtTime(v,this.c.currentTime);g.gain.exponentialRampToValueAtTime(.001,this.c.currentTime+d);o.start();o.stop(this.c.currentTime+d);}
  win(){this.b(523,.1);setTimeout(()=>this.b(659,.1),100);setTimeout(()=>this.b(784,.15),200);setTimeout(()=>this.b(1047,.3),300);}
  lose(){this.b(330,.1,'sawtooth');setTimeout(()=>this.b(220,.3,'sawtooth'),100);}
  click(){this.b(800,.05,'square',.05);}
  tick(){this.b(1200,.04,'square',.08);}
  deal(){this.b(600,.08,'triangle',.1);}
  jackpot(){[523,659,784,1047,1319,1568].forEach((f,i)=>setTimeout(()=>this.b(f,.15),i*80));}
}
const snd=new Snd();

function initBg(){
  const cv=document.getElementById('bg-canvas'),ctx=cv.getContext('2d');
  let w,h,ps=[];
  const rs=()=>{w=cv.width=innerWidth;h=cv.height=innerHeight;};rs();
  window.addEventListener('resize',rs);
  for(let i=0;i<50;i++)ps.push({x:Math.random()*1e3,y:Math.random()*1e3,vx:(Math.random()-.5)*.2,vy:(Math.random()-.5)*.2,r:Math.random()*1.5+.3,a:Math.random()});
  (function fr(){ctx.clearRect(0,0,w,h);ps.forEach(p=>{p.x+=p.vx;p.y+=p.vy;if(p.x<0)p.x=w;if(p.x>w)p.x=0;if(p.y<0)p.y=h;if(p.y>h)p.y=0;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fillStyle=`rgba(212,175,55,${p.a*.12})`;ctx.fill();});requestAnimationFrame(fr);})();
}

let _tt;
function showToast(msg){clearTimeout(_tt);let t=document.querySelector('.toast');if(!t){t=document.createElement('div');t.className='toast';document.body.appendChild(t);}t.textContent=msg;_tt=setTimeout(()=>t?.remove(),2500);}

function burst(win){
  const e=win?['‚≠ê','‚ú®','üí∞','üéâ']:['üí®'];
  for(let i=0;i<(win?8:3);i++){const el=document.createElement('div');el.className='particle';el.textContent=e[~~(Math.random()*e.length)];el.style.left=(innerWidth/2+(Math.random()-.5)*60)+'px';el.style.top='200px';el.style.animationDelay=(Math.random()*.3)+'s';document.body.appendChild(el);setTimeout(()=>el.remove(),1500);}
}

function BetInput({value,onChange,balance}){
  const p=[100,500,1000,5000];
  return <div>
    <div className="fld"><div className="flbl">–°—Ç–∞–≤–∫–∞ ‚òÖ</div><input className="inp" type="number" value={value} onChange={e=>onChange(+e.target.value)}/></div>
    <div className="pres">
      {p.map(v=><button key={v} className={`pre ${value===v?'on':''}`} onClick={()=>{snd.i();snd.click();onChange(v);}}>{v>=1000?v/1000+'K':v}</button>)}
      <button className="pre" onClick={()=>{snd.i();snd.click();onChange(Math.floor(balance/2));}}>¬Ω</button>
      <button className="pre" onClick={()=>{snd.i();snd.click();onChange(balance);}}>MAX</button>
    </div>
  </div>;
}
function Registration({onDone}){
  const [step,setStep]=useState(1);
  const [name,setName]=useState(tgUser?.first_name||'');
  const [err,setErr]=useState('');
  const [loading,setLoading]=useState(false);

  async function submit(){
    const n=name.trim();
    if(n.length<2||n.length>20){setErr('–û—Ç 2 –¥–æ 20 —Å–∏–º–≤–æ–ª–æ–≤');return;}
    if(!/^[a-zA-Z–∞-—è–ê-–Ø0-9_-]+$/.test(n)){setErr('–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, _ –∏ -');return;}
    setLoading(true);setErr('');
    const ref=tg?.initDataUnsafe?.start_param?.replace('ref_','');
    const r=await api('register',{username:n,ref_id:ref?+ref:null});
    if(r.ok){snd.i();snd.win();onDone({username:n,balance:r.balance||10000,vip:1});}
    else{setErr(r.error||'–û—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');setLoading(false);}
  }

  if(step===1)return(
    <div className="welcome">
      <div className="wlogo">ROYAL KENO KZ</div>
      <div style={{fontSize:11,color:'var(--mut)',letterSpacing:3,textTransform:'uppercase',marginBottom:24}}>–û–Ω–ª–∞–π–Ω –∫–∞–∑–∏–Ω–æ</div>
      <div style={{fontSize:34,marginBottom:24}}>üé∞ üÉè üé° üöÄ üé≤</div>
      <div style={{width:'100%',marginBottom:20}}>
        {[['üí∞','–°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å 10,000 ‚òÖ'],['üéÅ','–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞'],['üèÜ','–¢—É—Ä–Ω–∏—Ä—ã –∏ –¢–û–ü-10 –∏–≥—Ä–æ–∫–æ–≤'],['üë•','–†–µ—Ñ–µ—Ä–∞–ª–∫–∞ +500 ‚òÖ –∑–∞ –¥—Ä—É–≥–∞'],['üîí','–ê–Ω–æ–Ω–∏–º–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ Crypto Pay']].map(([ic,tx])=>(
          <div key={tx} className="perk"><span style={{fontSize:20}}>{ic}</span><span style={{fontSize:13}}>{tx}</span></div>
        ))}
      </div>
      <button className="btn btn-gold" onClick={()=>setStep(2)}>üé∞ –ù–ê–ß–ê–¢–¨ –ò–ì–†–ê–¢–¨</button>
    </div>
  );

  return(
    <div style={{padding:'20px 4px'}}>
      <div style={{textAlign:'center',marginBottom:20}}>
        <div style={{fontSize:36,marginBottom:8,animation:'float 2s ease infinite'}}>üëë</div>
        <div style={{fontFamily:"'Cinzel',serif",fontSize:16,fontWeight:700,marginBottom:4}}>–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å</div>
        <div style={{fontSize:11,color:'var(--mut)',letterSpacing:1}}>–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∏–∫–Ω–µ–π–º –¥–ª—è –∏–≥—Ä—ã</div>
      </div>
      <div className="fld">
        <div className="flbl">–í–∞—à –Ω–∏–∫–Ω–µ–π–º</div>
        <input className="inp" value={name} onChange={e=>setName(e.target.value)} placeholder="Lucky_Player" maxLength={20} onKeyDown={e=>e.key==='Enter'&&submit()} autoFocus/>
        {err&&<div style={{color:'var(--ruby)',fontSize:12,marginTop:5}}>{err}</div>}
      </div>
      <div style={{fontSize:11,color:'var(--mut)',marginBottom:16}}>2‚Äì20 —Å–∏–º–≤–æ–ª–æ–≤ ¬∑ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, _ –∏ -</div>
      <button className="btn btn-gold" onClick={submit} disabled={loading}>{loading?<><div className="spinner"/>–°–û–ó–î–ê–Å–ú...</>:'‚úÖ –°–û–ó–î–ê–¢–¨ –ü–†–û–§–ò–õ–¨'}</button>
      <button className="btn btn-ghost" style={{marginTop:8}} onClick={()=>setStep(1)}>‚Üê –ù–ê–ó–ê–î</button>
    </div>
  );
}

function ProfilePage({profile,balance,onRefresh}){
  const profit=(profile.total_win||0)-(profile.total_bet||0);
  const wr=profile.games>0?((profile.wins/profile.games)*100).toFixed(1):0;
  return <div>
    <div className="card" style={{textAlign:'center',padding:'20px 15px'}}>
      <div className="avatar">üëë</div>
      <div style={{fontFamily:"'Cinzel',serif",fontSize:18,fontWeight:700,marginBottom:8}}>{profile.username}</div>
      <div className="vip-b">‚òÖ VIP {profile.vip||1}</div>
      <div style={{fontFamily:"'Cinzel',serif",fontSize:28,fontWeight:900,color:'var(--gold2)',marginTop:14}}>{balance.toLocaleString()} ‚òÖ</div>
    </div>
    <div className="card">
      <div className="ctit">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
      {[['–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫',(profile.total_bet||0).toLocaleString()+' ‚òÖ'],['–í—Å–µ–≥–æ –≤—ã–∏–≥—Ä–∞–Ω–æ',(profile.total_win||0).toLocaleString()+' ‚òÖ'],['–ü—Ä–æ—Ñ–∏—Ç',(profit>=0?'+':'')+profit.toLocaleString()+' ‚òÖ',profit>=0?'var(--em2)':'var(--ruby)'],['–ò–≥—Ä —Å—ã–≥—Ä–∞–Ω–æ',profile.games||0],['–ü–æ–±–µ–¥',profile.wins||0],['–í–∏–Ω—Ä–µ–π—Ç',wr+'%','var(--gold2)']].map(([k,v,c])=>(
        <div key={k} className="sl"><span className="sk">{k}</span><span className="sv" style={{color:c||'var(--txt)'}}>{v}</span></div>
      ))}
    </div>
    <button className="btn btn-ghost" onClick={onRefresh}>üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
  </div>;
}

function BonusPage({balance,setBalance,vip}){
  const [status,setStatus]=useState(null);
  const [timeLeft,setTimeLeft]=useState('');
  const [loading,setLoading]=useState(false);
  const amt=Math.floor(20*(1+(vip-1)*.2));

  useEffect(()=>{api('bonus_status',{},true).then(r=>{if(r.ok){setStatus(r.can_claim?'can':'wait');if(r.time_left)setTimeLeft(r.time_left);}});},[]);

  async function claim(){
    setLoading(true);
    const r=await api('claim_bonus');
    if(r.ok){snd.i();snd.win();burst(true);setBalance(b=>b+r.bonus);setStatus('win');showToast(`üéÅ +${r.bonus} ‚òÖ –ø–æ–ª—É—á–µ–Ω–æ!`);}
    else{setTimeLeft(r.time_left||'');setStatus('wait');}
    setLoading(false);
  }

  return <div>
    <div className="card" style={{textAlign:'center',padding:'20px 15px'}}>
      <div style={{fontFamily:"'Cinzel',serif",fontSize:38,fontWeight:900,color:'var(--gold2)',animation:'float 2s ease infinite'}}>{amt} ‚òÖ</div>
      <div style={{fontSize:11,color:'var(--mut)',letterSpacing:2,textTransform:'uppercase',marginTop:4}}>–ë–æ–Ω—É—Å –¥–Ω—è ¬∑ VIP {vip}</div>
      {timeLeft&&<div style={{fontFamily:"'Cinzel',serif",fontSize:20,fontWeight:700,color:'var(--ruby)',marginTop:8}}>‚è≥ {timeLeft}</div>}
    </div>
    {status==='win'&&<div className="res rw"><div className="rbig">+{amt} ‚òÖ</div><div className="rsub">–ü–û–õ–£–ß–ï–ù–û!</div></div>}
    {status==='wait'&&<div className="res rt"><div className="rbig">‚è≥</div><div className="rsub">–£–ñ–ï –ü–û–õ–£–ß–ï–ù ¬∑ –°–õ–ï–î–£–Æ–©–ò–ô –ß–ï–†–ï–ó {timeLeft}</div></div>}
    {(status==='can'||!status)&&<button className="btn btn-gold" onClick={claim} disabled={loading||!status}>{loading?<><div className="spinner"/>–ü–û–õ–£–ß–ê–ï–ú...</>:'üéÅ –ü–û–õ–£–ß–ò–¢–¨ –ë–û–ù–£–°'}</button>}
    <div className="card" style={{marginTop:12}}>
      <div className="ctit">VIP –±–æ–Ω—É—Å—ã</div>
      {[1,2,3,4,5].map(v=><div key={v} className="sl"><span className="sk">VIP {v} {'‚≠ê'.repeat(v)}</span><span className="sv" style={{color:vip>=v?'var(--gold2)':'var(--mut)'}}>{Math.floor(20*(1+(v-1)*.2))} ‚òÖ</span></div>)}
    </div>
  </div>;
}

function TopupPage({balance,setBalance}){
  const [amount,setAmount]=useState(10);
  const [step,setStep]=useState(1);
  const [inv,setInv]=useState(null);
  const [loading,setLoading]=useState(false);
  const rate=0.013;
  const stars=Math.floor(amount/rate);

  async function create(){
    if(amount<1)return;setLoading(true);
    const r=await api('create_invoice',{amount_usdt:amount});
    if(r.ok){setInv(r);setStep(2);}else showToast('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è');
    setLoading(false);
  }
  async function check(){
    setLoading(true);
    const r=await api('check_invoice',{invoice_id:inv?.invoice_id});
    if(r.ok&&r.paid){snd.i();snd.win();burst(true);setBalance(b=>b+(r.stars||stars));setStep(3);}
    else showToast('‚è≥ –ü–ª–∞—Ç—ë–∂ –µ—â—ë –Ω–µ –ø–æ—Å—Ç—É–ø–∏–ª');
    setLoading(false);
  }

  if(step===3)return <div>
    <div className="res rw" style={{marginTop:0}}><div className="rbig">+{inv?.stars||stars} ‚òÖ</div><div className="rsub">–ë–ê–õ–ê–ù–° –ü–û–ü–û–õ–ù–ï–ù!</div></div>
    <div className="card" style={{marginTop:12,textAlign:'center'}}><div style={{fontSize:32,marginBottom:8}}>‚úÖ</div><div style={{fontWeight:700}}>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ</div><div style={{color:'var(--mut)',fontSize:12,marginTop:4}}>–ë–∞–ª–∞–Ω—Å: {balance.toLocaleString()} ‚òÖ</div></div>
    <button className="btn btn-gold" onClick={()=>setStep(1)}>üí≥ –ü–æ–ø–æ–ª–Ω–∏—Ç—å –µ—â—ë</button>
  </div>;

  if(step===2)return <div>
    <div className="card" style={{textAlign:'center'}}>
      <div style={{fontSize:36,marginBottom:10}}>üí≥</div>
      <div style={{fontFamily:"'Cinzel',serif",fontSize:18,fontWeight:700,marginBottom:4}}>–°—á—ë—Ç —Å–æ–∑–¥–∞–Ω</div>
      <div style={{color:'var(--mut)',fontSize:12,marginBottom:14}}>–û–ø–ª–∞—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ @CryptoBot</div>
      {[['–°—É–º–º–∞',amount+' USDT'],['–ó–∞—á–∏—Å–ª–∏—Ç—Å—è',stars.toLocaleString()+' ‚òÖ'],['–î–µ–π—Å—Ç–≤—É–µ—Ç','1 —á–∞—Å']].map(([k,v])=><div key={k} className="sl"><span className="sk">{k}</span><span className="sv">{v}</span></div>)}
    </div>
    <a href={inv?.pay_url} target="_blank" style={{textDecoration:'none',display:'block',marginBottom:8}}><button className="btn btn-gold">üí≥ –û–¢–ö–†–´–¢–¨ @CRYPTOBOT</button></a>
    <button className="btn btn-em" onClick={check} disabled={loading}>{loading?<><div className="spinner"/>–ü–†–û–í–ï–†–Ø–ï–ú...</>:'‚úÖ –Ø –û–ü–õ–ê–¢–ò–õ'}</button>
    <button className="btn btn-ghost" style={{marginTop:8}} onClick={()=>setStep(1)}>‚Üê –ù–ê–ó–ê–î</button>
  </div>;

  return <div>
    <div style={{display:'inline-flex',alignItems:'center',gap:4,background:'rgba(212,175,55,.1)',border:'1px solid var(--bdr2)',padding:'4px 10px',borderRadius:20,fontSize:11,color:'var(--gold2)',marginBottom:12}}>üìä 1 USDT = {Math.floor(1/rate).toLocaleString()} ‚òÖ</div>
    <div className="card">
      <div className="ctit">–°—É–º–º–∞</div>
      <div className="fld"><div className="flbl">–í USDT</div><input className="inp" type="number" value={amount} onChange={e=>setAmount(+e.target.value)}/></div>
      <div className="pres">{[5,10,25,50,100].map(v=><button key={v} className={`pre ${amount===v?'on':''}`} onClick={()=>setAmount(v)}>{v}$</button>)}</div>
      {amount>=1&&<div style={{textAlign:'center',padding:'8px 0',color:'var(--gold2)',fontSize:15,fontFamily:"'Cinzel',serif",fontWeight:700}}>–ó–∞—á–∏—Å–ª–∏—Ç—Å—è: {stars.toLocaleString()} ‚òÖ</div>}
    </div>
    <div className="card">
      <div className="ctit">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</div>
      <div className="pay-opt on"><span style={{fontSize:22}}>üíé</span><div style={{flex:1}}><div style={{fontWeight:700,fontSize:13}}>Crypto Pay ¬∑ USDT</div><div style={{fontSize:11,color:'var(--mut)',marginTop:2}}>–ê–Ω–æ–Ω–∏–º–Ω–æ ¬∑ –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ</div></div><div style={{width:18,height:18,borderRadius:'50%',background:'var(--gold)',display:'flex',alignItems:'center',justifyContent:'center',fontSize:10,color:'#000'}}>‚úì</div></div>
    </div>
    <button className="btn btn-gold" onClick={create} disabled={amount<1||loading}>{loading?<><div className="spinner"/>–°–û–ó–î–ê–Å–ú...</>:`üí≥ –ü–û–ü–û–õ–ù–ò–¢–¨ ${amount} USDT`}</button>
  </div>;
}

function WithdrawPage({balance,setBalance}){
  const [stars,setStars]=useState(1000);
  const [step,setStep]=useState(1);
  const [loading,setLoading]=useState(false);
  const MIN=1000;
  const usdt=(stars*0.013).toFixed(2);

  async function withdraw(){
    if(stars<MIN||stars>balance)return;
    setLoading(true);
    const r=await api('withdraw',{stars});
    if(r.ok){snd.i();snd.win();setBalance(b=>b-stars);setStep(2);}
    else showToast(r.error||'‚ùå –û—à–∏–±–∫–∞ –≤—ã–≤–æ–¥–∞');
    setLoading(false);
  }

  if(step===2)return <div>
    <div className="res rw" style={{marginTop:0}}><div className="rbig">{usdt} USDT</div><div className="rsub">–í–´–í–û–î –í–´–ü–û–õ–ù–ï–ù</div></div>
    <div className="card" style={{marginTop:12,textAlign:'center'}}><div style={{fontSize:32,marginBottom:8}}>‚úÖ</div><div style={{fontWeight:700}}>–î–µ–Ω—å–≥–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã</div><div style={{color:'var(--mut)',fontSize:12,marginTop:4}}>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ @CryptoBot ¬∑ –û—Å—Ç–∞—Ç–æ–∫: {balance.toLocaleString()} ‚òÖ</div></div>
    <button className="btn btn-gold" onClick={()=>setStep(1)}>üí∞ –í—ã–≤–µ—Å—Ç–∏ –µ—â—ë</button>
  </div>;

  return <div>
    <div style={{display:'inline-flex',alignItems:'center',gap:4,background:'rgba(212,175,55,.1)',border:'1px solid var(--bdr2)',padding:'4px 10px',borderRadius:20,fontSize:11,color:'var(--gold2)',marginBottom:12}}>üìä 1000 ‚òÖ = {(1000*0.013).toFixed(2)} USDT</div>
    <div className="card">
      <div className="ctit">–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞</div>
      <div style={{textAlign:'right',fontSize:12,color:'var(--mut)',marginBottom:8}}>–î–æ—Å—Ç—É–ø–Ω–æ: {balance.toLocaleString()} ‚òÖ</div>
      <div className="fld"><div className="flbl">–í –∑–≤—ë–∑–¥–∞—Ö ‚òÖ</div><input className="inp" type="number" value={stars} onChange={e=>setStars(+e.target.value)}/></div>
      <div className="pres">{[1000,5000,10000,50000].map(v=><button key={v} className={`pre ${stars===v?'on':''}`} onClick={()=>setStars(v)}>{v>=1000?v/1000+'K':v}</button>)}<button className="pre" onClick={()=>setStars(balance)}>MAX</button></div>
      {stars>=MIN&&<div style={{textAlign:'center',padding:'8px 0',color:'var(--em2)',fontSize:15,fontFamily:"'Cinzel',serif",fontWeight:700}}>–ü–æ–ª—É—á–∏—Ç–µ: {usdt} USDT</div>}
    </div>
    <div className="card">
      <div className="ctit">–ö—É–¥–∞</div>
      <div className="pay-opt on"><span style={{fontSize:22}}>üíé</span><div style={{flex:1}}><div style={{fontWeight:700,fontSize:13}}>Crypto Pay ¬∑ USDT</div><div style={{fontSize:11,color:'var(--mut)',marginTop:2}}>–ü—Ä—è–º–æ –≤ –≤–∞—à @CryptoBot –∫–æ—à–µ–ª—ë–∫</div></div></div>
    </div>
    {stars>balance&&<div style={{color:'var(--ruby)',fontSize:12,marginBottom:8,textAlign:'center'}}>‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥</div>}
    {stars<MIN&&<div style={{color:'var(--ruby)',fontSize:12,marginBottom:8,textAlign:'center'}}>‚ùå –ú–∏–Ω–∏–º—É–º {MIN.toLocaleString()} ‚òÖ</div>}
    <button className="btn btn-gold" onClick={withdraw} disabled={stars<MIN||stars>balance||loading}>{loading?<><div className="spinner"/>–í–´–í–û–î–ò–ú...</>:`üí∞ –í–´–í–ï–°–¢–ò ${usdt} USDT`}</button>
  </div>;
}

function HistoryPage(){
  const [items,setItems]=useState(null);
  const ICO={'keno':'üé∞','slots':'üé∞','blackjack':'üÉè','roulette':'üé°','crash':'üöÄ'};
  useEffect(()=>{api('history',{limit:30},true).then(r=>{if(r.ok)setItems(r.history);else setItems([]);});},[]);
  const fmt=iso=>{try{const d=new Date(iso);return`${d.getDate()}.${String(d.getMonth()+1).padStart(2,'0')} ${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`;}catch{return'';} };
  if(!items)return <div className="loading"><div className="spinner"/>–ó–∞–≥—Ä—É–∂–∞–µ–º...</div>;
  if(!items.length)return <div style={{textAlign:'center',padding:40,color:'var(--mut)'}}>üìú –°—ã–≥—Ä–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∏–≥—Ä—É!</div>;
  return <div className="card">
    <div className="ctit">–ü–æ—Å–ª–µ–¥–Ω–∏–µ {items.length} –∏–≥—Ä</div>
    {items.map((h,i)=>{const p=h.win-h.bet;return<div key={i} className="hrow"><div className="hico">{ICO[h.game]||'üé≤'}</div><div className="hinfo"><div className="hgame">{(h.game||'').toUpperCase()}</div><div className="hdate">{fmt(h.date)} ¬∑ —Å—Ç–∞–≤–∫–∞ {(h.bet||0).toLocaleString()} ‚òÖ</div></div><div className={`hamt ${p>0?'w':'l'}`}>{p>0?'+':''}{p.toLocaleString()} ‚òÖ</div></div>;})}
  </div>;
}

function TopPage(){
  const [top,setTop]=useState(null);
  useEffect(()=>{api('top',{},true).then(r=>{if(r.ok)setTop(r.top);else setTop([]);});},[]);
  const RC=(i)=>i===0?'g':i===1?'s':i===2?'b':'';
  const MED=['ü•á','ü•à','ü•â'];
  if(!top)return <div className="loading"><div className="spinner"/>–ó–∞–≥—Ä—É–∂–∞–µ–º...</div>;
  return <div className="card">
    <div className="ctit">üèÜ –¢–û–ü-10 –∏–≥—Ä–æ–∫–æ–≤</div>
    {top.map((p,i)=><div key={i} className="trow"><div className={`trank ${RC(i)}`}>{i<3?MED[i]:i+1+'.'}</div><div className="tname">{p.username||'–ê–Ω–æ–Ω–∏–º'} <span style={{fontSize:10,color:'var(--mut)'}}>VIP-{p.vip}</span></div><div className="tbal">{(p.balance||0).toLocaleString()} ‚òÖ</div></div>)}
  </div>;
}

function RefPage({userId}){
  const [count,setCount]=useState(0);
  const botName="YOUR_BOT";
  const link=`https://t.me/${botName}?start=ref_${userId}`;
  useEffect(()=>{api('referrals',{},true).then(r=>{if(r.ok)setCount(r.count||0);});},[]);
  function copy(){navigator.clipboard?.writeText(link).then(()=>showToast('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!')).catch(()=>{});snd.click();}
  function share(){tg?.switchInlineQuery?.(`–ò–≥—Ä–∞–π –≤ Royal Keno KZ! üé∞\n${link}`);}
  return <div>
    <div className="card" style={{textAlign:'center',padding:'18px 15px'}}>
      <div style={{fontSize:36,marginBottom:8}}>üë•</div>
      <div style={{fontFamily:"'Cinzel',serif",fontSize:16,fontWeight:700,marginBottom:4}}>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</div>
      <div style={{color:'var(--mut)',fontSize:12}}>+500 ‚òÖ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞</div>
    </div>
    <div style={{display:'flex',gap:10,marginBottom:14}}>
      <div className="rss"><div className="rssv">{count}</div><div className="rssl">–î—Ä—É–∑–µ–π</div></div>
      <div className="rss"><div className="rssv">{(count*500).toLocaleString()}</div><div className="rssl">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ ‚òÖ</div></div>
    </div>
    <div className="card">
      <div className="ctit">–í–∞—à–∞ —Å—Å—ã–ª–∫–∞</div>
      <div className="ref-link" onClick={copy}>{link}</div>
      <div className="g2"><button className="btn btn-gold" onClick={copy}>üìã –ö–û–ü–ò–†–û–í–ê–¢–¨</button><button className="btn btn-ghost" onClick={share}>üì§ –ü–û–î–ï–õ–ò–¢–¨–°–Ø</button></div>
    </div>
    <div className="card">
      <div className="ctit">–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç</div>
      {[['1Ô∏è‚É£','–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π'],['2Ô∏è‚É£','–î—Ä—É–≥ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è'],['3Ô∏è‚É£','–í–∞–º +500 ‚òÖ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏']].map(([n,t])=><div key={n} className="sl"><span className="sk">{n} {t}</span></div>)}
    </div>
  </div>;
}
function CrashGame({balance,setBalance}){
  const [bet,setBet]=useState(100);
  const [target,setTarget]=useState(2.0);
  const [phase,setPhase]=useState('idle');
  const [mult,setMult]=useState(1.00);
  const [crashAt,setCrashAt]=useState(null);
  const [result,setResult]=useState(null);
  const iv=useRef(null),cv=useRef(null),pts=useRef([]);
  function gen(){const r=Math.random();return r<.05?1.0:Math.min(Math.round((.95/r)*100)/100,100);}
  function draw(){const c=cv.current;if(!c)return;const ctx=c.getContext('2d'),w=c.width,h=c.height;ctx.clearRect(0,0,w,h);if(pts.current.length<2)return;const p=pts.current,mx=Math.max(...p,2);const tx=i=>(i/(p.length-1))*w*.9+w*.05;const ty=v=>h-(v/mx)*h*.85-h*.05;ctx.beginPath();ctx.moveTo(tx(0),ty(p[0]));p.forEach((v,i)=>i>0&&ctx.lineTo(tx(i),ty(v)));ctx.strokeStyle='#00FF9A';ctx.lineWidth=2.5;ctx.shadowColor='#00FF9A';ctx.shadowBlur=8;ctx.stroke();}
  function start(){
    if(bet<50||bet>balance)return;snd.i();
    const cp=gen();setCrashAt(cp);setPhase('fly');setResult(null);setBalance(b=>b-bet);pts.current=[1];let cur=1.0;
    iv.current=setInterval(()=>{cur=Math.round((cur+cur*.025)*100)/100;setMult(cur);pts.current.push(cur);draw();
      if(cur>=target){clearInterval(iv.current);const win=Math.floor(bet*target);setBalance(b=>b+win);setPhase('idle');setResult({win,profit:win-bet,ok:true});snd.win();burst(true);api('play',{game:'crash',bet,win});return;}
      if(cur>=cp){clearInterval(iv.current);setPhase('boom');setResult({win:0,profit:-bet,ok:false});snd.lose();setTimeout(()=>setPhase('idle'),1500);api('play',{game:'crash',bet,win:0});}
    },120);
  }
  useEffect(()=>()=>clearInterval(iv.current),[]);
  return <div>
    <div className="arena">
      <canvas ref={cv} width="400" height="185" style={{position:'absolute',inset:0,width:'100%',height:'100%'}}/>
      <div className={`cmult ${phase}`}>{mult.toFixed(2)}x</div>
      <div className={`cst ${phase}`}>{phase==='idle'&&'–°–¢–ê–í–¨–¢–ï'}{phase==='fly'&&'üöÄ –í –ü–û–õ–Å–¢–ï'}{phase==='boom'&&`üí• –ö–†–ê–® ${crashAt}x`}</div>
    </div>
    {phase==='idle'&&<><BetInput value={bet} onChange={setBet} balance={balance}/>
    <div className="card"><div className="ctit">–ó–∞–±—Ä–∞—Ç—å –Ω–∞</div><div className="g3" style={{marginBottom:8}}>{[1.5,2,3,5,10].map(p=><button key={p} className={`pre ${target===p?'on':''}`} onClick={()=>setTarget(p)}>x{p}</button>)}</div><input className="inp" type="number" step=".1" value={target} onChange={e=>setTarget(Math.max(1.01,Math.min(100,+e.target.value||1.01)))}/></div>
    <button className="btn btn-gold" onClick={start} disabled={bet<50||bet>balance}>üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨</button></>}
    {result&&<div className={`res ${result.ok?'rw':'rl'}`}><div className="rbig">{result.ok?`+${result.win.toLocaleString()}`:result.profit.toLocaleString()} ‚òÖ</div><div className="rsub">{result.ok?`–ó–ê–ë–†–ê–õ–ò –ù–ê x${target}`:`–£–ü–ê–õ –ù–ê x${crashAt}`}</div></div>}
  </div>;
}

const SYMS=['üçã','üçä','üçá','üîî','üíé','7Ô∏è‚É£','üé∞'],WGTS=[30,25,20,12,8,4,1],PAYS={'üçã':2,'üçä':3,'üçá':5,'üîî':10,'üíé':25,'7Ô∏è‚É£':50,'üé∞':200};
function wr(){let s=WGTS.reduce((a,b)=>a+b),r=Math.random()*s;for(let i=0;i<SYMS.length;i++){r-=WGTS[i];if(r<=0)return SYMS[i];}return SYMS[0];}

function SlotsGame({balance,setBalance}){
  const [bet,setBet]=useState(100);
  const [reels,setReels]=useState(['üíé','üíé','üíé']);
  const [spin,setSpin]=useState([false,false,false]);
  const [win,setWin]=useState(null);
  const [busy,setBusy]=useState(false);
  function go(){
    if(bet<50||bet>balance||busy)return;snd.i();setBusy(true);setWin(null);setBalance(b=>b-bet);
    const final=[wr(),wr(),wr()];setSpin([true,true,true]);
    [0,1,2].forEach(i=>setTimeout(()=>{snd.deal();setSpin(s=>{const n=[...s];n[i]=false;return n;});setReels(r=>{const n=[...r];n[i]=final[i];return n;});
      if(i===2){const [a,b2,c]=final;let w=0,txt='';if(a===b2&&b2===c){w=Math.floor(bet*PAYS[a]);txt=`–¢—Ä–∏ ${a}! √ó${PAYS[a]}`;}else if(a===b2||b2===c||a===c){w=Math.floor(bet*.5);txt='–î–≤–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è √ó0.5';}else txt='–ù–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π';if(w>0){setBalance(b=>b+w);snd.win();if(w>bet*5)snd.jackpot();burst(true);}else snd.lose();setWin({w,profit:w-bet,txt});setBusy(false);api('play',{game:'slots',bet,win:w});}
    },400+i*350));
  }
  return <div>
    <div className="smach">
      <div className="reels">{reels.map((s,i)=><div key={i} className={`reel ${spin[i]?'':''}${win?.w>0&&!spin[i]?' win':''}`}>{spin[i]?SYMS[~~(Math.random()*SYMS.length)]:s}</div>)}</div>
      <div className="sline"/>
    </div>
    <BetInput value={bet} onChange={setBet} balance={balance}/>
    <button className="btn btn-gold" onClick={go} disabled={busy||bet<50||bet>balance}>{busy?'‚è≥ –ö–†–£–¢–ò–¢–°–Ø...':'üé∞ –ö–†–£–¢–ò–¢–¨'}</button>
    {win&&<div className={`res ${win.w>0?'rw':'rl'}`}><div className="rbig">{win.w>0?`+${win.w.toLocaleString()}`:win.profit.toLocaleString()} ‚òÖ</div><div className="rsub">{win.txt}</div></div>}
    <div className="card" style={{marginTop:12}}><div className="ctit">–í—ã–ø–ª–∞—Ç—ã</div>{Object.entries(PAYS).map(([s,m])=><div key={s} className="sl"><span className="sk">{s} {s} {s}</span><span className="sv" style={{color:'var(--gold2)'}}>√ó{m}</span></div>)}</div>
  </div>;
}

const S5=['‚ô†','‚ô•','‚ô¶','‚ô£'],V5=['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
function mkDk(){return V5.flatMap(v=>S5.map(s=>v+s)).sort(()=>Math.random()-.5);}
function cVal(c){const v=c.slice(0,-1);if('JQK'.includes(v))return 10;if(v==='A')return 11;return+v;}
function hVal(h){let t=h.reduce((a,c)=>a+cVal(c),0),ac=h.filter(c=>c.startsWith('A')).length;while(t>21&&ac){t-=10;ac--;}return t;}
function isR(c){return c.endsWith('‚ô•')||c.endsWith('‚ô¶');}
function Card({c,back}){if(back)return <div className="pc bk">üÇ†</div>;const v=c.slice(0,-1),s=c.slice(-1);return <div className={`pc ${isR(c)?'rd':'wh'}`}><div>{v}</div><div style={{fontSize:10}}>{s}</div><span className="pcs">{s}</span></div>;}

function BJGame({balance,setBalance}){
  const [bet,setBet]=useState(100);
  const [phase,setPhase]=useState('bet');
  const [deck,setDeck]=useState([]);
  const [player,setPlayer]=useState([]);
  const [dealer,setDealer]=useState([]);
  const [result,setResult]=useState(null);
  function deal(){if(bet<50||bet>balance)return;snd.i();const d=mkDk(),p=[d.pop(),d.pop()],dl=[d.pop(),d.pop()];setDeck(d);setPlayer(p);setDealer(dl);setResult(null);setBalance(b=>b-bet);snd.deal();setTimeout(()=>snd.deal(),150);setPhase('play');if(hVal(p)===21)setTimeout(()=>finish(p,dl,d,bet),400);}
  function hit(){const d=[...deck],p=[...player,d.pop()];snd.deal();setDeck(d);setPlayer(p);const v=hVal(p);if(v>21)finish(p,dealer,deck,bet);else if(v===21)setTimeout(()=>finish(p,dealer,d,bet),300);}
  function stand(p2=player,dl2=dealer,d2=deck,b2=bet){const fd=[...dl2],fd2=[...d2];while(hVal(fd)<17)fd.push(fd2.pop());setDealer(fd);finish(p2,fd,fd2,b2);}
  function dbl(){if(balance<bet)return;setBalance(b=>b-bet);const nb=bet*2,d=[...deck],p=[...player,d.pop()];snd.deal();setDeck(d);setPlayer(p);if(hVal(p)>21)finish(p,dealer,d,nb);else stand(p,dealer,d,nb);}
  function finish(p,dl,d,b){const pv=hVal(p),dv=hVal(dl);let win=0,txt='',type='lose';if(pv>21)txt='üí• –ü–µ—Ä–µ–±–æ—Ä!';else if(pv===21&&p.length===2){win=Math.floor(b*2.5);txt='üéâ –ë–õ–≠–ö–î–ñ–ï–ö! √ó2.5';type='win';}else if(dv>21||pv>dv){win=b*2;txt='üéâ –ü–æ–±–µ–¥–∞!';type='win';}else if(pv===dv){win=b;txt='ü§ù –ù–∏—á—å—è';type='tie';}else txt='üòî –î–∏–ª–µ—Ä –ø–æ–±–µ–¥–∏–ª';if(win>0){setBalance(b2=>b2+win);snd.win();if(win>b*2)snd.jackpot();burst(win>b);}else snd.lose();setResult({win,profit:win-b,txt,type});setPhase('done');api('play',{game:'blackjack',bet:b,win});}
  return <div>
    <div className="felt">
      {phase!=='bet'&&<><div className="hlbl">–î–∏–ª–µ—Ä {phase==='done'?`(${hVal(dealer)})`:''}</div><div className="hand">{dealer.map((c,i)=><Card key={i} c={c} back={phase==='play'&&i===1}/>)}</div><div style={{borderTop:'1px solid rgba(255,255,255,.06)',margin:'7px 0'}}/><div className="hlbl">–í—ã ({hVal(player)})</div><div className="hand">{player.map((c,i)=><Card key={i} c={c}/>)}</div></>}
      {phase==='bet'&&<div style={{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',height:'100%',gap:8,paddingTop:20}}><div style={{fontSize:42,animation:'float 2s ease infinite'}}>üÉè</div><div style={{fontSize:10,letterSpacing:3,color:'rgba(255,255,255,.2)',textTransform:'uppercase'}}>–£–∫–∞–∂–∏—Ç–µ —Å—Ç–∞–≤–∫—É</div></div>}
    </div>
    {(phase==='bet'||phase==='done')&&<BetInput value={bet} onChange={setBet} balance={balance}/>}
    {phase==='bet'&&<button className="btn btn-gold" onClick={deal} disabled={bet<50||bet>balance}>üÉè –†–ê–ó–î–ê–¢–¨</button>}
    {phase==='play'&&<div className="g2" style={{gap:8}}><button className="btn btn-em" onClick={hit}>üëä –ï–©–Å</button><button className="btn btn-ghost" onClick={()=>stand()}>‚úã –°–¢–û–ü</button>{player.length===2&&balance>=bet&&<button className="btn btn-gold" style={{gridColumn:'span 2'}} onClick={dbl}>üí∞ –£–î–í–û–ò–¢–¨</button>}</div>}
    {phase==='done'&&result&&<><div className={`res r${result.type}`}><div className="rbig">{result.win>0?`+${result.win.toLocaleString()}`:result.profit.toLocaleString()} ‚òÖ</div><div className="rsub">{result.txt}</div></div><button className="btn btn-gold" style={{marginTop:8}} onClick={()=>setPhase('bet')}>üîÑ –°–ù–û–í–ê</button></>}
  </div>;
}

const RN=new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
const BT2=[{id:'red',l:'üî¥ –ö—Ä–∞—Å–Ω–æ–µ',m:2},{id:'black',l:'‚ö´ –ß—ë—Ä–Ω–æ–µ',m:2},{id:'even',l:'–ß–Å–¢–ù–û–ï',m:2},{id:'odd',l:'–ù–ï–ß–Å–¢–ù–û–ï',m:2},{id:'low',l:'1‚Äì18',m:2},{id:'high',l:'19‚Äì36',m:2}];

function RouletteGame({balance,setBalance}){
  const [bet,setBet]=useState(100);
  const [type,setType]=useState('red');
  const [spin,setSpin]=useState(false);
  const [result,setResult]=useState(null);
  const [rot,setRot]=useState(0);
  const [last,setLast]=useState(null);
  function go(){
    if(bet<50||bet>balance||spin)return;snd.i();setSpin(true);setResult(null);setBalance(b=>b-bet);
    const num=~~(Math.random()*37);setLast(num);setRot(r=>r+1440+Math.random()*360);
    setTimeout(()=>{const col=num===0?'green':RN.has(num)?'red':'black';let win=0;if(type==='red'&&col==='red')win=bet*2;else if(type==='black'&&col==='black')win=bet*2;else if(type==='even'&&num!==0&&num%2===0)win=bet*2;else if(type==='odd'&&num%2===1)win=bet*2;else if(type==='low'&&num>=1&&num<=18)win=bet*2;else if(type==='high'&&num>=19&&num<=36)win=bet*2;if(win>0){setBalance(b=>b+win);snd.win();burst(true);}else snd.lose();setResult({win,profit:win-bet,num,col});setSpin(false);api('play',{game:'roulette',bet,win});},2600);
  }
  return <div>
    <div className="ws"><div style={{position:'relative'}}><div className="wp"/><div className="wo" style={{transform:`rotate(${rot}deg)`}}><div className="wi">{last??'?'}</div></div></div></div>
    <div className="bts">{BT2.map(t=><button key={t.id} className={`bt ${type===t.id?'on':''}`} onClick={()=>{snd.click();setType(t.id);}}>{t.l} <span style={{color:'var(--mut)',fontSize:10}}>√ó{t.m}</span></button>)}</div>
    <BetInput value={bet} onChange={setBet} balance={balance}/>
    <button className="btn btn-gold" onClick={go} disabled={spin||bet<50||bet>balance}>{spin?'‚è≥ –ö–†–£–¢–ò–¢–°–Ø...':'üé° –ö–†–£–¢–ò–¢–¨'}</button>
    {result&&<div className={`res ${result.win>0?'rw':'rl'}`}><div style={{fontSize:16,marginBottom:5}}>–í—ã–ø–∞–ª–æ: <b style={{color:result.col==='red'?'var(--ruby)':result.col==='green'?'var(--em2)':'var(--txt)'}}>{result.num} {result.col==='red'?'üî¥':result.col==='green'?'üü¢':'‚ö´'}</b></div><div className="rbig">{result.win>0?`+${result.win.toLocaleString()}`:result.profit.toLocaleString()} ‚òÖ</div><div className="rsub">{result.win>0?'–í–´–ò–ì–†–´–®':'–ü–†–û–ò–ì–†–´–®'}</div></div>}
  </div>;
}

const KP={1:{1:3},2:{2:12},3:{2:1,3:42},4:{2:1,3:4,4:120},5:{3:1,4:8,5:800},6:{3:1,4:4,5:88,6:1500},7:{4:1,5:18,6:300,7:4500},8:{5:9,6:90,7:1500,8:10000},9:{4:1,5:6,6:44,7:300,8:4000,9:25000},10:{5:2,6:20,7:142,8:1000,9:4500,10:100000}};

function KenoGame({balance,setBalance}){
  const [bet,setBet]=useState(100);
  const [sel,setSel]=useState(new Set());
  const [drawn,setDrawn]=useState(new Set());
  const [hits,setHits]=useState(new Set());
  const [result,setResult]=useState(null);
  const [busy,setBusy]=useState(false);
  function tog(n){if(busy)return;snd.click();setSel(s=>{const ns=new Set(s);ns.has(n)?ns.delete(n):ns.size<10&&ns.add(n);return ns;});setDrawn(new Set());setHits(new Set());setResult(null);}
  function auto(){const ns=new Set();while(ns.size<10)ns.add(~~(Math.random()*80)+1);setSel(ns);setDrawn(new Set());setHits(new Set());setResult(null);}
  function play(){
    if(!sel.size||bet<50||bet>balance||busy)return;snd.i();setBusy(true);setResult(null);setBalance(b=>b-bet);
    const dr=new Set();while(dr.size<20)dr.add(~~(Math.random()*80)+1);
    const ht=new Set([...sel].filter(n=>dr.has(n)));const m=KP[sel.size]?.[ht.size]||0;const win=Math.floor(bet*m);
    if(win>0){setBalance(b=>b+win);setTimeout(()=>{snd.win();if(win>bet*10)snd.jackpot();},500);}else setTimeout(()=>snd.lose(),1000);
    const arr=[...dr];let i=0;
    const iv=setInterval(()=>{snd.tick();setDrawn(d=>new Set([...d,arr[i]]));if(ht.has(arr[i]))setHits(h=>new Set([...h,arr[i]]));i++;if(i>=arr.length){clearInterval(iv);setResult({win,profit:win-bet,hits:ht.size,spot:sel.size,m});setBusy(false);if(win>0)burst(true);api('play',{game:'keno',bet,spot:sel.size,hits:ht.size,win});}},60);
  }
  return <div>
    <div className="ksts">
      <div><div className="ksv">{sel.size}<span style={{color:'var(--mut)',fontSize:11}}>/10</span></div><div className="ksl">–í—ã–±—Ä–∞–Ω–æ</div></div>
      <div><div className="ksv">{drawn.size}<span style={{color:'var(--mut)',fontSize:11}}>/20</span></div><div className="ksl">–í—ã–ø–∞–ª–æ</div></div>
      <div><div className="ksv" style={{color:'var(--em2)'}}>{hits.size}</div><div className="ksl">–°–æ–≤–ø–∞–ª–æ</div></div>
    </div>
    <div className="kg">{Array.from({length:80},(_,i)=>i+1).map(n=>{const iS=sel.has(n),iH=hits.has(n),iD=drawn.has(n)&&!iH;return <div key={n} className={`kn ${iS&&!iD&&!iH?'sel':''} ${iD?'drw':''} ${iH?'hit':''}`} onClick={()=>tog(n)}>{n}</div>;})}</div>
    <BetInput value={bet} onChange={setBet} balance={balance}/>
    <div className="g2" style={{marginBottom:8}}><button className="btn btn-ghost" onClick={()=>{setSel(new Set());setDrawn(new Set());setHits(new Set());setResult(null);}}>–û–ß–ò–°–¢–ò–¢–¨</button><button className="btn btn-ghost" onClick={auto}>–ê–í–¢–û</button></div>
    <button className="btn btn-gold" onClick={play} disabled={busy||!sel.size||bet<50||bet>balance}>{busy?'‚è≥ –†–û–ó–´–ì–†–´–®...':'üé∞ –ò–ì–†–ê–¢–¨'}</button>
    {result&&<div className={`res ${result.win>0?'rw':'rl'}`}><div className="rbig">{result.win>0?`+${result.win.toLocaleString()}`:result.profit.toLocaleString()} ‚òÖ</div><div className="rsub">{result.hits}/{result.spot} –°–û–í–ü–ê–î–ï–ù–ò–ô {result.m>0?`√ó ${result.m}`:''}</div></div>}
  </div>;
}
const GAME_TABS=[{id:'keno',l:'üé∞ KENO'},{id:'crash',l:'üöÄ –ö–†–ê–®'},{id:'slots',l:'üé∞ –°–õ–û–¢–´'},{id:'bj',l:'üÉè –ë–ñ'},{id:'rlt',l:'üé° –†–¢–ö'}];
const BOT_TABS=[{id:'play',l:'üéÆ',n:'–ò–≥—Ä—ã'},{id:'bonus',l:'üéÅ',n:'–ë–æ–Ω—É—Å'},{id:'topup',l:'üí≥',n:'–ü–æ–ø–æ–ª–Ω.'},{id:'withdraw',l:'üí∞',n:'–í—ã–≤–æ–¥'},{id:'history',l:'üìú',n:'–ò—Å—Ç–æ—Ä–∏—è'},{id:'top',l:'üèÜ',n:'–¢–û–ü'},{id:'ref',l:'üë•',n:'–î—Ä—É–∑—å—è'},{id:'profile',l:'üëë',n:'–ü—Ä–æ—Ñ–∏–ª—å'}];
const TITLES={play:'–ò–≥—Ä—ã',bonus:'–ë–æ–Ω—É—Å –¥–Ω—è',topup:'–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ',withdraw:'–í—ã–≤–æ–¥',history:'–ò—Å—Ç–æ—Ä–∏—è –∏–≥—Ä',top:'–¢–û–ü-10',ref:'–†–µ—Ñ–µ—Ä–∞–ª–∫–∞',profile:'–ü—Ä–æ—Ñ–∏–ª—å'};

function App(){
  const [reg,setReg]=useState(null);
  const [profile,setProfile]=useState(null);
  const [balance,setBalance]=useState(10000);
  const [tab,setTab]=useState('play');
  const [gt,setGt]=useState('keno');

  useEffect(()=>{
    tg?.ready();tg?.expand();
    tg?.setHeaderColor?.('#050508');
    tg?.setBackgroundColor?.('#050508');
    initBg();
    api('profile',{},true).then(r=>{
      if(r.ok&&r.data){setProfile(r.data);setBalance(r.data.balance||10000);setReg(true);}
      else setReg(false);
    });
  },[]);

  function onReg(d){setProfile({username:d.username,vip:1,total_bet:0,total_win:0,wins:0,games:0});setBalance(d.balance||10000);setReg(true);}

  async function refresh(){
    const r=await api('profile');
    if(r.ok&&r.data){setProfile(r.data);setBalance(r.data.balance);}
    showToast('‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ');
  }

  // LOADING
  if(reg===null)return(
    <div style={{display:'flex',alignItems:'center',justifyContent:'center',height:'100vh',flexDirection:'column',gap:12,background:'var(--obs)'}}>
      <div style={{fontFamily:"'Cinzel',serif",fontSize:18,fontWeight:900,background:'linear-gradient(135deg,#8B6914,#F5D060,#D4AF37)',WebkitBackgroundClip:'text',WebkitTextFillColor:'transparent',letterSpacing:3}}>ROYAL KENO KZ</div>
      <div className="spinner" style={{width:28,height:28,borderWidth:3,marginTop:8}}/>
    </div>
  );

  // REGISTRATION
  if(!reg)return(
    <div className="app">
      <div className="hdr"><div className="logo">ROYAL KENO KZ</div></div>
      <div className="scr"><Registration onDone={onReg}/></div>
    </div>
  );

  // MAIN APP
  const isPlay=tab==='play';
  return(
    <div className="app">
      {/* HEADER */}
      <div className="hdr">
        <div style={{display:'flex',alignItems:'center',gap:8}}>
          {!isPlay&&<button style={{background:'none',border:'none',color:'var(--gold)',fontSize:18,cursor:'pointer',lineHeight:1,padding:'0 2px'}} onClick={()=>setTab('play')}>‚Äπ</button>}
          <div className="logo">{isPlay?'ROYAL KENO KZ':TITLES[tab]}</div>
        </div>
        <div className="bal-pill" onClick={()=>setTab('profile')}>
          <span style={{fontSize:13}}>‚òÖ</span>
          <span className="amt">{balance.toLocaleString()}</span>
        </div>
      </div>

      {/* GAME SUB-NAV */}
      {isPlay&&<div className="nav">
        {GAME_TABS.map(t=><button key={t.id} className={`nv ${gt===t.id?'on':''}`} onClick={()=>{snd.click();setGt(t.id);}}>{t.l}</button>)}
      </div>}

      {/* PAGES */}
      <div className="scr">
        {tab==='play'&&<>
          {gt==='keno'  &&<KenoGame     balance={balance} setBalance={setBalance}/>}
          {gt==='crash' &&<CrashGame    balance={balance} setBalance={setBalance}/>}
          {gt==='slots' &&<SlotsGame    balance={balance} setBalance={setBalance}/>}
          {gt==='bj'    &&<BJGame       balance={balance} setBalance={setBalance}/>}
          {gt==='rlt'   &&<RouletteGame balance={balance} setBalance={setBalance}/>}
        </>}
        {tab==='bonus'   &&<BonusPage    balance={balance} setBalance={setBalance} vip={profile?.vip||1}/>}
        {tab==='topup'   &&<TopupPage    balance={balance} setBalance={setBalance}/>}
        {tab==='withdraw'&&<WithdrawPage balance={balance} setBalance={setBalance}/>}
        {tab==='history' &&<HistoryPage/>}
        {tab==='top'     &&<TopPage/>}
        {tab==='ref'     &&<RefPage userId={tgUser?.id||0}/>}
        {tab==='profile' &&<ProfilePage profile={profile||{}} balance={balance} onRefresh={refresh}/>}
      </div>

      {/* BOTTOM NAV */}
      <div className="bnav">
        {BOT_TABS.map(t=>(
          <button key={t.id} className="bni" onClick={()=>{snd.click();setTab(t.id);}}>
            <span>{t.l}</span>
            <span className="dot" style={{background:tab===t.id?'var(--gold)':'transparent'}}/>
          </button>
        ))}
      </div>
    </div>
  );
}

ReactDOM.render(<App/>,document.getElementById('root'));
</script>
</body>
</html>
